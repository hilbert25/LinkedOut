<!DOCTYPE html>
 <html class="no-js"> <!--<![endif]-->
    <head>
        <title></title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <meta name="description" content="FlexyCodes - FlexyCard vCard Template. Creating my personal page!"/>
        <link  rel="stylesheet" type="text/css" href="../src/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="../src/css/jquery.mCustomScrollbar.css" />
        <link rel="stylesheet" type="text/css" href="../src/css/colors/DarkBlue.css" id="colors-style" />     
        <link rel="stylesheet" type="text/css" href="../src/css/main.css" /> 
        <style>
            @media only screen and (max-width : 991px){
                .resp-vtabs .resp-tabs-container {
                    margin-left: 13px;
                }
            }
			@media only screen and (min-width : 800px) and (max-width : 991px){
                .resp-vtabs .resp-tabs-container {
                    margin-left: 13px;
					width:89%;
                }
            }		
        </style>
    </head>
    <body>
        <div class="wrapper">
            <section class="tab-content">
                <div class="container">
                    <div class="row">
                    <div class="col-md-12">
                          <div class="row">   
                                <div class="col-md-9 flexy_content" style="padding-left: 0;padding-right: 0;">
                                    <div id="verticalTab">
                                        <ul class="resp-tabs-list">                                        
                                            <li class="tabs-contact hi-icon-wrap hi-icon-effect-5 hi-icon-effect-5a" data-tab-name="contact" style="margin-bottom: 48px !important;">      
                                            </li>
                                         </ul>
                                        <div class="resp-tabs-container">
                                            <div id="profile" class="content_2">
<h1 class="h-bloc">简历</h1>
<input type="button" onclick ="save()" value="保存全部内容"/>
<div class="row top-p">
    <div class="col-md-6 profile-l">
        <div class="title_content">
            <div class="text_content" id="name_title">简历</div>
            <div class="clear"></div>
        </div>
		   <ul class="about">
            <li>
                <i class="glyphicon glyphicon-user"></i>
                <label>姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名</label>
                <input class="value" id="name" readonly="true" style="border: 0px;background-color:transparent"></input>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('name')" id="name_btn">点击修改</i>
                <div class="clear"></div>
            </li>
            <li>
                <i class="glyphicon glyphicon-adjust"></i>
                <label>性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别</label>
                <select id="gender">
                    <option value="男">男</option>
                    <option value="女">女</option>
                </select>
                <span class="value" id="gender"></span>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('gender')" id="gender_btn">点击修改</i>
                <div class="clear"></div>
            </li>
            <li>
                <i class="glyphicon glyphicon-calendar"></i>
                <label>出生年份</label>
                <select id="birth_year">

                </select>
                <span class="value" id="birth_year"></span>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('birth_year')" id="birth_year_btn">点击修改</i>
                <div class="clear"></div>
            </li>
            <li>
                <i class="glyphicon glyphicon-envelope"></i>
                <label>电子邮件</label>
                <input class="value" id="email" readonly="true" style="border: 0px;background-color:transparent"></input>
                <span class="value" id="email"></span>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('email')" id="email_btn">点击修改</i>
                <div class="clear"></div>
            </li>

            <li>
                <i class="glyphicon glyphicon-phone"></i>
                <label>手机号码</label>
                <input class="value" id="phone_number" readonly="true" style="border: 0px;background-color:transparent"></input>
                <span class="value" id="phone_number"></span>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('phone_number')" id="phone_number_btn">点击修改</i>
                <div class="clear"></div>
            </li>

            <li>
                <i class="glyphicon glyphicon-road"></i>
                <label>当前职务</label>
                <input class="value" id="position" readonly="true" style="border: 0px;background-color:transparent"></input>
                <span class="value" id="position"></span>
                <i class="glyphicon glyphicon-tag" onclick="changeReadOnly('position')" id="position_btn">点击修改</i>
                <div class="clear"></div>
            </li>
        </ul>


    </div>
    <!-- End left-wrap -->


</div>

    <div class="clear"></div>
    <div class="border-list"></div>
	
    <div class="row">
    <div class="col-md-12">
        <div class="bottom-p">
            <div class="title_content">
                <div class="text_content">个人经历</div>
                <div class="clear"></div>
            </div>
    
            <div class="panel-group" id="accordion">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" class="collapse_tabs">
                                教育经历
                                <i class="glyphicon glyphicon-chevron-up" style="float: right;font-size: 13px;"></i>
                            </a>
                        </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in">
                        <form class="form-inline" role="form" id="edu_0">
                            <div class="form-group">
                              <label>学校</label>
                              <input type="text" class="form-control" id="school_0" placeholder="">
                              <label>专业</label>
                              <input type="text" class="form-control" id="major_0" placeholder="">
                              <select id="degree_0">
                                  <option value="学士">学士</option>
                                  <option value="硕士">硕士</option>
                                  <option value="博士">博士</option>
                              </select>
                                <label>起始年份</label>
                                <select id="edu_begin_year_0"></select>
                                <label>起始月份</label>
                                <select id="edu_begin_month_0"></select>
                                <label>结束年份</label>
                                <select id="edu_end_year_0"></select>
                                <label>结束月份</label>
                                <select id="edu_end_month_0"></select>
                            </div>
                            <p id="edu_auth_state_0" value="undeal">尚未认证</p>
                            <input type="button" onclick="confirm_edu(edu_0)" value="undeal"></input>
                          </form>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" class="collapse_tabs">
                                工作经历
                                <i class="glyphicon glyphicon-chevron-down" style="float: right;font-size: 13px;"></i>
                            </a>
                        </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form class="form-inline" role="form" id="work_0">
                                <div class="form-group">
                                  <label>公司</label>
                                  <input type="text" class="form-control" id="company_0" placeholder="">
                                  <label>职务</label>
                                  <input type="text" class="form-control" id="position_0" placeholder="">
                                  <label>起始年份</label>
                                  <select id="work_begin_year_0"></select>
                                  <label>起始月份</label>
                                  <select id="work_begin_month_0"></select>
                                  <label>结束年份</label>
                                  <select id="work_end_year_0"></select>
                                  <label>结束月份</label>
                                  <select id="work_end_month_0"></select>
                                </div>
                              </form> </div>
                    </div>
                </div>
            </div>
    
        </div>
    </div>
  </div>
</div>
        <script type="text/javascript" src="../src/js/jquery.min.js"></script>
        <script type="text/javascript" src="../src/js/bootstrap.min.js"></script> 
        <script type="text/javascript" src="../src/js/easyResponsiveTabs.min.js"></script> 	
        <script type="text/javascript" src="../src/js/jquery.mCustomScrollbar.concat.min.js"></script>		
        <script type="text/javascript" src="../src/js/main.js"></script>
        <script src="../libs/nebulas.js"></script>
        <script src="../libs/nebPay.js"></script>
        <script type="text/javascript" src="../libs/util.js"></script>
<script type="text/javascript">
    "use strict";
    var nebulas = require("nebulas");
    var Account = nebulas.Account;
    var neb = new nebulas.Neb();
    var NebPay = require("nebpay");
    var nebPay = new NebPay();
    var dappAddress = getContractAddress();
    var EMAIL="";
    async function getData(args){
        neb.setRequest(new nebulas.HttpRequest("https://testnet.nebulas.io"));
        var serialNumber;
        var from = Account.NewAccount().getAddressString();
        var value = "0";   
        var nonce = "0";   
        var gas_price = "1000000" 
        var gas_limit = "2000000" ; 
        var contract = { 
            "function": "get",  
            "args": "[\""+args+"\"]"           
        };
        var r = await (neb.api.call(from, dappAddress, value, nonce, gas_price, gas_limit, contract).then(function (res) {
            return res['result'];  
        }));
        return r;
    }

    async function setData(value){
        value = value.replace(/"/g,"'");
        neb.setRequest(new nebulas.HttpRequest("https://testnet.nebulas.io"));
        nebPay.call(dappAddress, "0", "set", '["' + value+ '"]', {
        });
    }

    function changeReadOnly(id){
        var label = document.getElementById(id);
        if(label.getAttribute("readonly") =="true"){
            label.removeAttribute("readonly");
            label.setAttribute("style","border: 0px;");
        }else{
            label.setAttribute("readonly","true");
            label.setAttribute("style","border: 0px;background-color:transparent");
        }
        console.log(label);
    }

    function save(){
        var name = document.getElementById("name").value;
        var gender = document.getElementById("gender").value;
        var email = document.getElementById("email").value;
        var birth_year = document.getElementById("birth_year").value;
        var phone_number = document.getElementById("phone_number").value;
        var resume = {};
        resume["name"] = name;
        resume["gender"] = gender;
        resume["email"] = email;
        resume["birth_year"] = birth_year;
        resume["phone_number"] = phone_number;
        //都放到dict最后转json
        //resume["edu_exp"] = createEduJSON();
        var value = {};
        value[EMAIL+RESUME] = resume;
        value = JSON.stringify(value);
        console.log(value);
        //setData(value);
    }

    function initBirthYear(){
        var birthYear = document.getElementById("birth_year");
        for(var i=1900;i<=2018;i++){
            var option = document.createElement("option");
            option.setAttribute("value",i.toString());
            option.innerHTML=i;
            birthYear.appendChild(option);
        }
    }
    function initExpYearAndMonth(){
        for(var i=0;;i++){
            if(document.getElementById("edu_begin_year_"+i.toString())){
                var edu_begin_year = document.getElementById("edu_begin_year_"+i.toString());
                var edu_end_year = document.getElementById("edu_end_year_"+i.toString());
                for(var j=1900;j<=2018;j++){
                    var option1 = document.createElement("option");
                    option1.setAttribute("value",j.toString());
                    option1.innerHTML=j;
                    edu_begin_year.appendChild(option1);
                    var option2 = document.createElement("option");
                    option2.setAttribute("value",j.toString());
                    option2.innerHTML=j;
                    edu_begin_year.appendChild(option2);
                    edu_end_year.appendChild(option2);
                }
                var edu_begin_month = document.getElementById("edu_begin_month_"+i.toString());
                var edu_end_month = document.getElementById("edu_end_month_"+i.toString());
                for(var j=1;j<=12;j++){
                    var option1 = document.createElement("option");
                    option1.setAttribute("value",j.toString());
                    option1.innerHTML=j;
                    edu_begin_month.appendChild(option1);
                    var option2 = document.createElement("option");
                    option2.setAttribute("value",j.toString());
                    option2.innerHTML=j;
                    edu_end_month.appendChild(option2);
                }
            }else{
                break;
            }
        }
    }
    async function getResume(){
        var resume = await getData(EMAIL+RESUME);
        return resume;
    }

    function createEduJSON(){
        var edu_exp = [];
        for(var i=0;;i++){
            if(document.getElementById("edu_"+i.toString())){
                var edu = {};
                edu["school"] = document.getElementById("school_"+i.toString()).value;
                edu["major"] = document.getElementById("major_"+i.toString()).value;
                edu["degree"] = document.getElementById("degree_"+i.toString()).value;
                edu["edu_begin_year"] = document.getElementById("edu_begin_year_"+i.toString()).value;
                edu["edu_begin_month"] = document.getElementById("edu_begin_month_"+i.toString()).value;
                edu["edu_end_year"] = document.getElementById("edu_end_year_"+i.toString()).value;
                edu["edu_end_month"] = document.getElementById("edu_end_month_"+i.toString()).value;
                edu["edu_auth_state"] = document.getElementById("edu_auth_state_"+i.toString()).innerHTML;
                edu_exp.push(edu);
            }else{
                break;
            }
        }
        return JSON.stringify(edu_exp);
    }
    function init(){
        EMAIL = location.search.substring(1,location.search.length);
        initBirthYear();
        initExpYearAndMonth();
    }
    function getExpCount(exp){//exp =edu or work
        var count = 0;
        for(var i=0;;i++){
            if(document.getElementById(exp+"_"+i.toString())){
                count+=1;
            }else{
                break;
            }
        }
        return count;
    }
    window.onload=function(){
        init();
        var data= Promise.resolve(getResume())
        Promise.resolve(getResume()).then(function (resume) { 
            resume = myJSONParse(resume);
            if(resume == null){
                return;
            }
            document.getElementById("name").setAttribute("value",resume["name"]);
            document.getElementById("email").setAttribute("value",resume["email"]);
            document.getElementById("phone_number").setAttribute("value",resume["phone_number"]);
            document.getElementById("position").setAttribute("value",resume["position"]); 
            document.getElementById("birth_year").value = resume["birth_year"];  
            document.getElementById("gender").value = resume["gender"];    
            if(resume.hasOwnProperty("edu_exp")){

            }
            if(resume.hasOwnProperty("work_exp")){

            }
        })
        }
</script>

    </body>
</html>